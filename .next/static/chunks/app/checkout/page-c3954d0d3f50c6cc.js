(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[279],{995:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(5155),a=r(7368),l=r(5855),n=r(9142),i=r(1769),c=r(4493);let d=()=>{let{user:e}=(0,n.k)(e=>({user:e.user})),{data:t,isLoading:r}=(0,i.I)({queryKey:["cart",e],queryFn:()=>c.oE.get(c.u6,{params:{customer_id:null==e?void 0:e.id}}).then(e=>e.data),enabled:!!(null==e?void 0:e.id),staleTime:7e10,cacheTime:7e10});return{cartList:t,isLoading:r}};var o=r(5695),u=r(2115),m=r(2624);let p=(0,a.c)("pk_test_51PT7R1P8uwwvPPsCx5W5jcoeX1nFLd33F093vg8e4EX4qaZfeIdMv0LEAm0RxDqGjpOzefw2VfP5lXseuLuOSfHX00mWZ3AhKQ"),x={layout:"accordion"},h=()=>{var e;let t=(0,l.useStripe)(),r=(0,l.useElements)(),[a,n]=(0,u.useState)(null),[i,c]=(0,u.useState)(null),[o,p]=(0,u.useState)(!1);(0,u.useEffect)(()=>{if(!t)return;let e=new URLSearchParams(window.location.search).get("payment_intent_client_secret");e&&t.retrievePaymentIntent(e).then(e=>{let{paymentIntent:t}=e;switch(t.status){case"succeeded":c("Payment succeeded!");break;case"processing":c("Your payment is processing.");break;case"requires_payment_method":c("Your payment was not successful, please try again.");break;default:c("Something went wrong.")}})},[t]);let h=async e=>{if(e.preventDefault(),!t||!r)return;p(!0);let{error:s}=await t.confirmPayment({elements:r,confirmParams:{return_url:"https://www.buddyuae.com/checkout/payment/success"}});"card_error"===s.type||"validation_error"===s.type?c(s.message):c("An unexpected error occurred."),p(!1)},{cartList:f,isLoading:b}=d(),v=(0,m.A)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"text-center w-full text-[1.3rem] font-semibold py-4",children:"Complete Checkout"}),b?(0,s.jsx)("div",{className:"h-5 w-5 mx-auto my-28 animate-spin rounded-full border-b-2 border-blue"}):(0,s.jsxs)("div",{className:"px-4 mt-7 mb-20 sm:px-10 xl:px-48 lg:grid lg:gap-14 flex flex-col lg:grid-cols-12",children:[(0,s.jsx)("div",{className:"flex flex-col col-span-7",children:(0,s.jsx)("div",{className:"overflow-x-auto overflow-x-min",children:(0,s.jsxs)("table",{className:"table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"font-bold text-black text-[.9rem] border-b-1 border-[#6C7275]",children:[(0,s.jsx)("th",{className:"",children:"Product"}),(0,s.jsx)("th",{children:"Quantity"}),(0,s.jsx)("th",{children:"Price"})]})}),(0,s.jsxs)("tbody",{children:[null==f?void 0:null===(e=f.cart_items)||void 0===e?void 0:e.map(e=>(0,s.jsxs)("tr",{className:"",children:[(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:" flex items-center gap-4",children:[(0,s.jsx)("div",{className:"avatar",children:(0,s.jsx)("div",{className:"mask w-12 border border-black/20 rounded-md overflow-hidden lg:w-20 lg:h-24",children:(0,s.jsx)("img",{className:"h-full w-full object-contain",src:null==e?void 0:e.productImage,alt:null==e?void 0:e.name})})}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)("div",{className:"font-bold min-w-44 w-44 text-[.85rem]",children:null==e?void 0:e.name})})]})}),(0,s.jsx)("td",{className:"text-[.75rem] font-semibold",children:(0,s.jsx)("div",{className:"px-4",children:null==e?void 0:e.quantity})}),(0,s.jsxs)("td",{className:"text-[.75rem] font-semibold min-w-24 p-1",children:["AED ",v(null==e?void 0:e.unit_price)]})]},null==e?void 0:e.id)),(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"text-[.8rem] font-bold min-w-28 p-1",children:["Subtotal :AED ",v(null==f?void 0:f.subtotal)]}),(0,s.jsxs)("td",{className:"text-[.8rem] font-bold min-w-28 p-1",children:["Tax : AED ",v(null==f?void 0:f.tax_amount)]}),(0,s.jsxs)("td",{className:"text-[.8rem] font-bold min-w-28 p-1",children:["Total : AED ",v(null==f?void 0:f.grand_total)]})]})]})]})})}),(0,s.jsx)("div",{className:"flex h-fit md:h-96 col-span-5 flex-col",children:(0,s.jsxs)("form",{className:"w-full  md:px-7 pt-12 md:py-0",onSubmit:h,children:[(0,s.jsx)(l.PaymentElement,{className:"stripe-input mt-2",id:"payment-element",options:x}),(0,s.jsx)("button",{className:"bg-blue text-white rounded flex items-center justify-center text-sm font-medium h-12 w-full px-7 mt-10",disabled:o||!t||!r,id:"submit",children:(0,s.jsx)("span",{id:"button-text",children:o?(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"h-5 w-5 animate-spin rounded-full border-b-2 border-white"}),"Requesting"]}):"Pay now AED ".concat(v(null==f?void 0:f.grand_total))})}),i&&(0,s.jsx)("div",{id:"payment-message",children:i}),a&&(0,s.jsx)("div",{children:a})]})})]})]})},f={theme:"stripe",rules:{".Label":{marginBottom:"9px",color:"#0A0D13",fontWeight:500,fontSize:"0.84rem",letterSpacing:"0.2px",textTransform:"capitalize"},".Input":{boxShadow:"none",marginBottom:"4px",fontSize:"0.9rem"},".Input::placeholder":{fontSize:"0.9rem"}}},b=()=>{let{clientsecret:e}=(0,n.k)(e=>({clientsecret:e.clientsecret}));return console.log(e),e?(0,s.jsxs)("div",{className:"bg-white h-fit w-full gap-7",children:[(0,s.jsx)(l.Elements,{options:{appearance:f,clientSecret:e},stripe:p,children:(0,s.jsx)(h,{})}),(0,s.jsx)("div",{className:"flex"})]}):(0,o.redirect)("/cart")}},2624:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});var s=r(2115);let a=()=>(0,s.useCallback)(e=>new Intl.NumberFormat("ar-AE",{minimumFractionDigits:2,maximumFractionDigits:2}).format(e),[])},4493:(e,t,r)=>{"use strict";r.d(t,{$0:()=>k,Bt:()=>P,CC:()=>y,Cy:()=>g,DV:()=>j,Dc:()=>z,E:()=>l,Ec:()=>x,G5:()=>n,H3:()=>D,Hl:()=>m,K0:()=>d,LL:()=>A,Ou:()=>R,Ri:()=>q,Rn:()=>L,S3:()=>u,Ts:()=>S,WI:()=>C,Wd:()=>T,eY:()=>o,fX:()=>b,gy:()=>p,i1:()=>E,kW:()=>B,mN:()=>I,oE:()=>c,p3:()=>N,pN:()=>f,u6:()=>_,wy:()=>h,xR:()=>w,zv:()=>v});var s=r(3464);let a={baseURL:r(9509).env.NEXT_PUBLIC_API_URL||"https://admin.buddyuae.com/api"},l=s.A.create(a),n=s.A.create({...a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}),i=s.A.create({...a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}),c=s.A.create({...a,headers:{"Content-Type":"application/json"}});c.interceptors.request.use(e=>{let t=localStorage.getItem("secret_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let d=s.A.create({...a,headers:{"Content-Type":"multipart/form-data"}});d.interceptors.request.use(e=>{let t=localStorage.getItem("secret_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),i.interceptors.request.use(e=>{let t=localStorage.getItem("secret_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let o="user_register",u="login",m="send-otp",p="verify-otp",x="validate-otp",h="products/new-product-list",f="products/featured-product-list",b="category/category-product-list",v="products/all-product-list",w="brands/brand-product-list",g="products/product-view",j="products/add-review",y="/products/review-list",N="products/add-cart",_="products/cart-list",k="products/update-product-quantity",A="products/productwise-cart-delete",E="category/filter-category",S="brands/brand-list",P="brands/top-brand-list",C="coupon",I="coupon/check",D="coupon/promocode_detail",T="products/add-wishlist",q="products/remove-wishlist",L="subscriber/add-subscriber",z="contact",R="user/reset_password",B="seo/get"},4523:(e,t,r)=>{Promise.resolve().then(r.bind(r,995))},9142:(e,t,r)=>{"use strict";r.d(t,{k:()=>s});let s=(0,r(8693).vt)((e,t)=>({user:{},clientsecret:"",setUser:t=>{e(e=>({user:t}))},addClientSecret:t=>{e(e=>({clientsecret:t}))}}))}},e=>{var t=t=>e(e.s=t);e.O(0,[464,769,188,441,684,358],()=>t(4523)),_N_E=e.O()}]);